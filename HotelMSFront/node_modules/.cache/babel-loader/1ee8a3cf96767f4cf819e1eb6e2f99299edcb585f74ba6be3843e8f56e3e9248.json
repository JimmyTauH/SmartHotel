{"ast":null,"code":"export default {\n  name: \"ServiceBook\",\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      form: {\n        title: '',\n        time: '',\n        content: ''\n      },\n      services: [],\n      serviceOptions: [{\n        label: '房间清洁',\n        value: 'cleaning'\n      }, {\n        label: '早餐服务',\n        value: 'breakfast'\n      }, {\n        label: '接送服务',\n        value: 'transportation'\n      }],\n      rules: {\n        title: [{\n          required: true,\n          message: '请选择服务类型',\n          trigger: 'change'\n        }],\n        time: [{\n          required: true,\n          message: '请选择预约时间',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  mounted() {\n    this.loadServices();\n  },\n  computed: {\n    filteredServices() {\n      return this.services.map(service => ({\n        title: service.title,\n        time: new Date(service.time).toLocaleString(),\n        content: service.content\n      }));\n    },\n    isFormDisabled() {\n      return this.services.length >= 5; // 限制最多申请5个服务\n    }\n  },\n  methods: {\n    loadServices() {\n      if (!this.user.id) {\n        console.error(\"用户ID无效!无法加载服务!\");\n        return;\n      }\n      console.log(this.user.id);\n      this.$request.get(`/serviceBook/selectByUser/${this.user.id}`).then(res => {\n        this.services = res.data || [];\n      }).catch(err => {\n        console.error(\"加载服务出错:\", err);\n      });\n    },\n    submitRequest() {\n      this.$refs.formRef.validate().then(() => {\n        this.form.user = this.user.id;\n        this.$request.post('/serviceBook/add/', this.form).then(res => {\n          if (res.code === '200') {\n            this.$message.success('申请成功');\n            this.loadServices();\n            this.form = {\n              title: '',\n              time: '',\n              content: ''\n            };\n          } else {\n            this.$message.error(res.msg);\n          }\n        }).catch(err => {\n          console.error(\"申请服务出错:\", err);\n        });\n      }).catch(err => {\n        console.log('验证失败:', err);\n      });\n    },\n    deleteService(serviceId) {\n      this.$confirm('您确定删除该服务申请吗？', '确认删除', {\n        type: 'warning'\n      }).then(() => {\n        this.$request.delete(`/serviceBook/delete/${serviceId}`).then(res => {\n          if (res.code === '200') {\n            this.$message.success('删除成功');\n            this.loadServices();\n          } else {\n            this.$message.error(res.msg);\n          }\n        }).catch(err => {\n          console.error(\"删除服务出错:\", err);\n        });\n      }).catch(err => {\n        console.log('取消删除:', err);\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","JSON","parse","localStorage","getItem","form","title","time","content","services","serviceOptions","label","value","rules","required","message","trigger","mounted","loadServices","computed","filteredServices","map","service","Date","toLocaleString","isFormDisabled","length","methods","id","console","error","log","$request","get","then","res","catch","err","submitRequest","$refs","formRef","validate","post","code","$message","success","msg","deleteService","serviceId","$confirm","type","delete"],"sources":["src/views/front/ServiceBooking.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\" style=\"width: 50%\">\n    <div class=\"card\" style=\"font-weight: bold; font-size: 28px; display: flex\">\n      酒店服务申请\n    </div>\n    <div class=\"card\" style=\"margin-top: 10px\">\n      <div style=\"font-size: 28px; display: flex\">\n        已申请服务\n      </div>\n      <el-table :data=\"filteredServices\" style=\"width: 100%\">\n        <el-table-column prop=\"title\" label=\"服务类型\"></el-table-column>\n        <el-table-column prop=\"time\" label=\"预约时间\"></el-table-column>\n        <el-table-column prop=\"content\" label=\"备注\"></el-table-column>\n      </el-table>\n\n      <div style=\"font-size: 28px; display: flex; margin-top: 20px\">\n        申请服务\n      </div>\n      <el-form :model=\"form\" ref=\"formRef\" label-width=\"200px\" label-align=\"right\" :rules=\"rules\">\n        <el-form-item label=\"预约服务类型\" prop=\"title\" required>\n          <el-select v-model=\"form.title\" placeholder=\"选择服务类型\">\n            <el-option\n              v-for=\"option in serviceOptions\"\n              :key=\"option.value\"\n              :label=\"option.label\"\n              :value=\"option.value\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"预约服务时间\" prop=\"time\" required>\n          <el-date-picker v-model=\"form.time\" type=\"datetime\" placeholder=\"选择预约时间\"></el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"备注\" prop=\"content\">\n          <el-input type=\"textarea\" v-model=\"form.content\" placeholder=\"请输入备注\"></el-input>\n        </el-form-item>\n        <div style=\"margin-bottom: 20rpx; margin-left: 200px;\">\n          <el-button \n            style=\"background-color: #006eff\" \n            :disabled=\"isFormDisabled\" \n            class=\"my-button-primary\"\n            type=\"primary\" \n            @click=\"submitRequest\">\n            提交申请\n          </el-button>\n        </div>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"ServiceBook\",\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      form: {\n        title: '',\n        time: '',\n        content: ''\n      },\n      services: [],\n      serviceOptions: [\n        { label: '房间清洁', value: 'cleaning' },\n        { label: '早餐服务', value: 'breakfast' },\n        { label: '接送服务', value: 'transportation' },\n      ],\n      rules: {\n        title: [{ required: true, message: '请选择服务类型', trigger: 'change' }],\n        time: [{ required: true, message: '请选择预约时间', trigger: 'change' }],\n      }\n    }\n  },\n  mounted() {\n    this.loadServices();\n  },\n  computed: {\n    filteredServices() {\n      return this.services.map(service => ({\n        title: service.title,\n        time: new Date(service.time).toLocaleString(),\n        content: service.content\n      }));\n    },\n    isFormDisabled() {\n      return this.services.length >= 5; // 限制最多申请5个服务\n    },\n  },\n  methods: {\n    loadServices() {\n      if (!this.user.id) {\n        console.error(\"用户ID无效!无法加载服务!\");\n        return;\n      }\n      console.log(this.user.id);\n      this.$request.get(`/serviceBook/selectByUser/${this.user.id}`)\n        .then(res => {\n          this.services = res.data || [];\n        })\n        .catch(err => {\n          console.error(\"加载服务出错:\", err);\n        });\n    },\n    submitRequest() {\n      this.$refs.formRef.validate().then(() => {\n        this.form.user = this.user.id;\n        this.$request.post('/serviceBook/add/', this.form)\n          .then(res => {\n            if (res.code === '200') {\n              this.$message.success('申请成功');\n              this.loadServices();\n              this.form = { title: '', time: '', content: '' };\n            } else {\n              this.$message.error(res.msg);\n            }\n          })\n          .catch(err => {\n            console.error(\"申请服务出错:\", err);\n          });\n      }).catch(err => {\n        console.log('验证失败:', err);\n      });\n    },\n    deleteService(serviceId) {\n      this.$confirm('您确定删除该服务申请吗？', '确认删除', { type: 'warning' })\n        .then(() => {\n          this.$request.delete(`/serviceBook/delete/${serviceId}`)\n            .then(res => {\n              if (res.code === '200') {\n                this.$message.success('删除成功');\n                this.loadServices();\n              } else {\n                this.$message.error(res.msg);\n              }\n            })\n            .catch(err => {\n              console.error(\"删除服务出错:\", err);\n            });\n        }).catch(err => {\n          console.log('取消删除:', err);\n        });\n    }\n  }\n}\n</script>\n\n<style scoped>\n.my-button-primary {\n  background-color: #006eff !important;\n  height: 70rpx;\n  line-height: 70rpx;\n  font-size: 28rpx;\n}\n</style>\n"],"mappings":"AAoDA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,IAAA;QACAC,KAAA;QACAC,IAAA;QACAC,OAAA;MACA;MACAC,QAAA;MACAC,cAAA,GACA;QAAAC,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,EACA;MACAC,KAAA;QACAP,KAAA;UAAAQ,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAT,IAAA;UAAAO,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,YAAA;EACA;EACAC,QAAA;IACAC,iBAAA;MACA,YAAAX,QAAA,CAAAY,GAAA,CAAAC,OAAA;QACAhB,KAAA,EAAAgB,OAAA,CAAAhB,KAAA;QACAC,IAAA,MAAAgB,IAAA,CAAAD,OAAA,CAAAf,IAAA,EAAAiB,cAAA;QACAhB,OAAA,EAAAc,OAAA,CAAAd;MACA;IACA;IACAiB,eAAA;MACA,YAAAhB,QAAA,CAAAiB,MAAA;IACA;EACA;EACAC,OAAA;IACAT,aAAA;MACA,UAAAlB,IAAA,CAAA4B,EAAA;QACAC,OAAA,CAAAC,KAAA;QACA;MACA;MACAD,OAAA,CAAAE,GAAA,MAAA/B,IAAA,CAAA4B,EAAA;MACA,KAAAI,QAAA,CAAAC,GAAA,mCAAAjC,IAAA,CAAA4B,EAAA,IACAM,IAAA,CAAAC,GAAA;QACA,KAAA1B,QAAA,GAAA0B,GAAA,CAAApC,IAAA;MACA,GACAqC,KAAA,CAAAC,GAAA;QACAR,OAAA,CAAAC,KAAA,YAAAO,GAAA;MACA;IACA;IACAC,cAAA;MACA,KAAAC,KAAA,CAAAC,OAAA,CAAAC,QAAA,GAAAP,IAAA;QACA,KAAA7B,IAAA,CAAAL,IAAA,QAAAA,IAAA,CAAA4B,EAAA;QACA,KAAAI,QAAA,CAAAU,IAAA,2BAAArC,IAAA,EACA6B,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA,CAAAQ,IAAA;YACA,KAAAC,QAAA,CAAAC,OAAA;YACA,KAAA3B,YAAA;YACA,KAAAb,IAAA;cAAAC,KAAA;cAAAC,IAAA;cAAAC,OAAA;YAAA;UACA;YACA,KAAAoC,QAAA,CAAAd,KAAA,CAAAK,GAAA,CAAAW,GAAA;UACA;QACA,GACAV,KAAA,CAAAC,GAAA;UACAR,OAAA,CAAAC,KAAA,YAAAO,GAAA;QACA;MACA,GAAAD,KAAA,CAAAC,GAAA;QACAR,OAAA,CAAAE,GAAA,UAAAM,GAAA;MACA;IACA;IACAU,cAAAC,SAAA;MACA,KAAAC,QAAA;QAAAC,IAAA;MAAA,GACAhB,IAAA;QACA,KAAAF,QAAA,CAAAmB,MAAA,wBAAAH,SAAA,IACAd,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA,CAAAQ,IAAA;YACA,KAAAC,QAAA,CAAAC,OAAA;YACA,KAAA3B,YAAA;UACA;YACA,KAAA0B,QAAA,CAAAd,KAAA,CAAAK,GAAA,CAAAW,GAAA;UACA;QACA,GACAV,KAAA,CAAAC,GAAA;UACAR,OAAA,CAAAC,KAAA,YAAAO,GAAA;QACA;MACA,GAAAD,KAAA,CAAAC,GAAA;QACAR,OAAA,CAAAE,GAAA,UAAAM,GAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}